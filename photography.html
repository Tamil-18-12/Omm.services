<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Photography Services | OM Service</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">

    <!-- Bootstrap & Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Clerk Auth -->
    <script src="https://cdn.jsdelivr.net/npm/@clerk/clerk-js@latest/dist/clerk.browser.js" type="text/javascript"
        data-clerk-publishable-key="pk_test_ZXZvbHZlZC1ib2EtMS5jbGVyay5hY2NvdW50cy5kZXYk" crossorigin="anonymous">
        </script>

    <style>
        body {
            /* Animated gradient background */
            background: linear-gradient(135deg, #4a1a50, #19021C, #4a1a50);
            background-size: 200% 200%;
            animation: gradientBG 15s ease infinite;
            color: white;
            min-height: 100vh;
            font-family: 'Outfit', sans-serif;
            overflow-x: hidden;
        }

        @keyframes gradientBG {
            0% {
                background-position: 0% 50%;
            }

            50% {
                background-position: 100% 50%;
            }

            100% {
                background-position: 0% 50%;
            }
        }

        /* Glassmorphic Navbar */
        nav.navbar {
            padding: 15px 24px;
            background: rgba(55, 2, 62, 0.7);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(252, 220, 59, 0.2);
            z-index: 999;
        }

        .navbar-brand img {
            height: 54px;
            width: 55px;
            object-fit: cover;
        }

        .navbar-toggler {
            border: 2px solid #fcdc3b;
        }

        .navbar-toggler-icon {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%28252, 220, 59, 1%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e");
        }

        .navbar-nav .nav-link {
            position: relative;
            cursor: pointer;
            font-weight: 700;
            padding: 8px 16px !important;
            font-size: 1rem;
            color: white;
            transition: color .3s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .navbar-nav .nav-link::after {
            content: '';
            display: block;
            position: absolute;
            left: 20%;
            bottom: 2px;
            width: 60%;
            height: 3px;
            background: #fcdc3b;
            border-radius: 2px;
            transform: scaleX(0);
            transition: transform 0.3s;
        }

        .navbar-nav .nav-link:hover {
            color: #fcdc3b;
            background: rgba(252, 220, 59, 0.08);
            border-radius: 20px;
        }

        .navbar-nav .nav-link:hover::after {
            transform: scaleX(1);
        }

        .navbar-nav .nav-link.active {
            color: #fcdc3b;
        }

        .joi {
            padding: 6px 20px;
            background-color: gold;
            color: black;
            border-radius: 30px;
            font-size: 1rem;
            font-weight: bold;
            display: inline-block;
            box-shadow: 0 4px 18px #fcdc3b59;
            letter-spacing: 1px;
        }

        /* Glassmorphic Panel (Card) Styling - Matching .service-card from snippet */
        .glass-panel {
            background: rgba(255, 255, 255, 0.05);
            /* Slightly darker for content contrast */
            backdrop-filter: blur(12px);
            border: 1px solid rgba(252, 220, 59, 0.3);
            box-shadow: 0 8px 32px 0 rgba(19, 2, 28, 0.37);
            border-radius: 22px;
            transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .glass-panel:hover {
            transform: translateY(-5px);
            box-shadow: 0 16px 40px 0 rgba(19, 2, 28, 0.5);
            border-color: rgba(252, 220, 59, 0.7);
        }

        .text-gold {
            color: #fcdc3b !important;
        }

        .text-white-50 {
            color: rgba(255, 255, 255, 0.7) !important;
        }

        .badge.bg-gold {
            background-color: #fcdc3b !important;
            color: black !important;
        }

        /* Buttons */
        .btn-primary-glow {
            background: #fcdc3b;
            color: #000;
            border: none;
            padding: 12px 30px;
            border-radius: 50px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            transition: all 0.3s ease;
            box-shadow: 0 0 15px rgba(252, 220, 59, 0.4);
        }

        .btn-primary-glow:hover {
            background: #fff;
            transform: translateY(-2px);
            box-shadow: 0 0 25px rgba(252, 220, 59, 0.6);
        }

        .btn-secondary-glow {
            background: transparent;
            color: #fcdc3b;
            border: 2px solid #fcdc3b;
            padding: 10px 25px;
            border-radius: 50px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            transition: all 0.3s ease;
        }

        .btn-secondary-glow:hover {
            background: #fcdc3b;
            color: #000;
            box-shadow: 0 0 15px rgba(252, 220, 59, 0.3);
        }

        /* Modal Overrides */
        .modal-content {
            background: rgba(25, 2, 28, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(252, 220, 59, 0.3);
        }

        .form-control,
        .form-select {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(252, 220, 59, 0.3);
            color: white;
        }

        .form-control:focus,
        .form-select:focus {
            background: rgba(255, 255, 255, 0.1);
            border-color: #fcdc3b;
            color: white;
            box-shadow: 0 0 10px rgba(252, 220, 59, 0.3);
        }

        /* Typography */
        h1.hero-title {
            color: #fcdc3b;
            text-shadow: 0 0 20px rgba(252, 220, 59, 0.5);
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        /* TOAST NOTIFICATION STYLES */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
        }

        .toast-notify {
            background: rgba(25, 2, 28, 0.95);
            color: #fff;
            padding: 16px 24px;
            border-radius: 12px;
            margin-bottom: 10px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            gap: 12px;
            min-width: 300px;
            border-left: 5px solid #D4AF37;
            transform: translateX(120%);
            transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        .toast-notify.show {
            transform: translateX(0);
        }

        .toast-notify.success {
            border-left-color: #28a745;
        }

        .toast-notify.error {
            border-left-color: #dc3545;
        }

        .toast-icon {
            font-size: 1.2rem;
        }

        .toast-notify.success .toast-icon {
            color: #28a745;
        }

        .toast-notify.error .toast-icon {
            color: #dc3545;
        }
    </style>
</head>

<body>
    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg fixed-top">
        <div class="container">
            <a class="navbar-brand" href="index.html">
                <img src="logo-removebg-preview.png" alt="OM Service Logo">
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav mx-auto">
                    <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
                    <li class="nav-item"><a class="nav-link active" href="photography.html">Photography</a></li>
                    <li class="nav-item"><a class="nav-link" href="about.html">About Us</a></li>
                    <li class="nav-item"><a class="nav-link" href="contact.html">Contact</a></li>
                </ul>
                <div class="navbar-nav ms-auto">
                    <div id="user-button"></div>
                </div>
            </div>
        </div>
    </nav>

    <div class="container mt-5 pt-5 mb-5 ps-3 pe-3">
        <h1 class="hero-title text-center mb-5 mt-4">Capture The Moment</h1>

        <!-- Slideshow (Dynamic) -->
        <div class="slideshow-container mx-auto mb-5" style="max-width: 900px;">
            <div class="slide active" style="background-image: url('camer main.jpg');"></div>
            <div class="slide" style="background-image: url('video main.webp');"></div>
            <div class="slide" style="background-image: url('both main.jpg');"></div>
            <div class="slide-controls">
                <button class="slide-btn" onclick="changeSlide(-1)"><i class="bi bi-chevron-left"></i></button>
                <button class="slide-btn" onclick="changeSlide(1)"><i class="bi bi-chevron-right"></i></button>
            </div>
        </div>

        <div class="row g-5 justify-content-center mt-4">

            <div class="col-lg-10">
                <div class="glass-panel p-0 d-flex flex-column flex-md-row overflow-hidden hover-lift"
                    onclick="openDetailsModal('photo')">
                    <div class="col-md-5" style="min-height: 250px;">
                        <img src="camer main.jpg" alt="Pro Photography" class="w-100 h-100" style="object-fit: cover;">
                    </div>
                    <div class="col-md-7 p-4 p-md-5 d-flex flex-column justify-content-center">
                        <span class="badge bg-gold text-dark mb-2 align-self-start">Professional</span>
                        <h2 class="text-gold fw-bold mb-3">Professional Photography</h2>
                        <p class="text-white-50 mb-4">High-end cameras, expert lighting, and professional editing to
                            capture your most precious moments.</p>
                        <button class="btn-secondary-glow align-self-start"
                            onclick="event.stopPropagation(); openDetailsModal('photo')">
                            <i class="bi bi-info-circle me-2"></i>See Details
                        </button>
                    </div>
                </div>
            </div>

            <div class="col-lg-10">
                <div class="glass-panel p-0 d-flex flex-column flex-md-row overflow-hidden hover-lift"
                    onclick="openDetailsModal('video')">
                    <div class="col-md-5" style="min-height: 250px;">
                        <img src="video main.webp" alt="Cinematic Video" class="w-100 h-100" style="object-fit: cover;">
                    </div>
                    <div class="col-md-7 p-4 p-md-5 d-flex flex-column justify-content-center">
                        <span class="badge bg-gold text-dark mb-2 align-self-start">Cinematic</span>
                        <h2 class="text-gold fw-bold mb-3">Cinematic Videography</h2>
                        <p class="text-white-50 mb-4">Bring your story to life with our 4K cinematic video production
                            and storytelling.</p>
                        <button class="btn-secondary-glow align-self-start"
                            onclick="event.stopPropagation(); openDetailsModal('video')">
                            <i class="bi bi-info-circle me-2"></i>See Details
                        </button>
                    </div>
                </div>
            </div>

            <div class="col-lg-10">
                <div class="glass-panel p-0 d-flex flex-column flex-md-row overflow-hidden hover-lift"
                    onclick="openDetailsModal('combo')">
                    <div class="col-md-5" style="min-height: 250px;">
                        <img src="both main.jpg" alt="Combo Pack" class="w-100 h-100" style="object-fit: cover;">
                    </div>
                    <div class="col-md-7 p-4 p-md-5 d-flex flex-column justify-content-center">
                        <span class="badge bg-gold text-dark mb-2 align-self-start">Best Value</span>
                        <h2 class="text-gold fw-bold mb-3">All-Inclusive Package</h2>
                        <p class="text-white-50 mb-4">The complete media solution. Photography, Videography, Drone
                            shots, and premium albums.</p>
                        <button class="btn-secondary-glow align-self-start"
                            onclick="event.stopPropagation(); openDetailsModal('combo')">
                            <i class="bi bi-info-circle me-2"></i>See Details
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="text-center mt-5">
            <button class="btn-primary-glow btn-lg px-5" onclick="openBookingModal('General Inquiry')">
                Book A Session
            </button>
        </div>
    </div>

    <!-- Details Modal -->
    <div class="modal fade" id="detailsModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content glass-panel p-0 border-0">
                <div class="modal-header border-bottom border-white border-opacity-10">
                    <h5 class="modal-title text-gold fw-bold" id="detailTitle">Details</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-4 text-white" id="detailContent">
                    <!-- Dynamic Content -->
                </div>
                <div class="modal-footer border-top border-white border-opacity-10">
                    <button type="button" class="btn-secondary-glow" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn-primary-glow px-4" id="detailBookBtn">Book This Package</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Premium Booking Modal -->
    <div class="modal fade" id="bookingModal" tabindex="-1" aria-hidden="true" data-bs-backdrop="static">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content premium-booking">
                <div class="modal-header">
                    <div>
                        <h5 class="modal-title" id="bookingTitle"><i class="fas fa-camera-retro"></i> Book Session</h5>
                        <p class="mb-0 text-white-50 small ms-4">Fill in the details to confirm your shoot</p>
                    </div>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-4 p-md-5">

                    <!-- Context Banner -->
                    <div class="context-banner">
                        <i class="fas fa-film me-2"></i> <span id="displayPackage">Select Package</span>
                    </div>

                    <form id="bookingForm" onsubmit="handleBooking(event)">

                        <!-- Personal Info -->
                        <div class="form-section-title">
                            <i class="fas fa-user-circle"></i> Personal Information
                        </div>
                        <div class="row g-4 mb-4">
                            <div class="col-md-6">
                                <label class="premium-label"><i class="fas fa-user"></i> Full Name</label>
                                <input type="text" class="form-control-premium" id="name" required
                                    placeholder="Enter full name">
                            </div>
                            <div class="col-md-6">
                                <label class="premium-label"><i class="fas fa-phone"></i> Phone Number</label>
                                <input type="tel" class="form-control-premium" id="phone" required
                                    placeholder="Enter phone number">
                            </div>
                            <div class="col-md-6">
                                <label class="premium-label"><i class="fas fa-envelope"></i> Email Address</label>
                                <input type="email" class="form-control-premium" id="email" required
                                    placeholder="your@email.com">
                            </div>
                        </div>

                        <!-- Event Info -->
                        <div class="form-section-title">
                            <i class="fas fa-calendar-check"></i> Event Details
                        </div>
                        <div class="row g-4">
                            <div class="col-md-6">
                                <label class="premium-label"><i class="fas fa-calendar-day"></i> Event Date</label>
                                <input type="date" class="form-control-premium" id="date" required>
                            </div>
                            <div class="col-md-6">
                                <label class="premium-label"><i class="fas fa-glass-cheers"></i> Event Type</label>
                                <select class="form-control-premium form-select" id="eventType">
                                    <option value="Wedding">Wedding</option>
                                    <option value="Birthday">Birthday</option>
                                    <option value="Corporate">Corporate</option>
                                    <option value="Outdoor Shoot">Outdoor Shoot</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label class="premium-label"><i class="fas fa-hourglass-half"></i> Duration</label>
                                <input type="text" class="form-control-premium" id="duration"
                                    placeholder="e.g. 1 Day / 4 Hours">
                            </div>
                            <div class="col-12">
                                <label class="premium-label"><i class="fas fa-map-marked-alt"></i> Address /
                                    Venue</label>
                                <textarea class="form-control-premium" id="address" required rows="2"
                                    placeholder="Full venue address"></textarea>
                            </div>
                        </div>

                        <button type="submit" class="btn-premium-action">
                            Confirm Booking
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div class="modal fade" id="successModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content glass-panel border-gold text-center p-4">
                <div class="mb-3">
                    <i class="bi bi-check-circle-fill text-gold" style="font-size: 4rem;"></i>
                </div>
                <h3 class="text-white fw-bold mb-2">Booking Confirmed!</h3>
                <p class="text-white-50">Our team will contact you shortly.</p>
                <button type="button" class="btn-secondary-glow mt-3" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>

    <!-- Bootstrap Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // --- Dynamic Content Loading ---
        async function loadDynamicContent() {
            try {
                const res = await fetch('/api/services?category=photography');
                const data = await res.json();

                if (data && data.length > 0) {
                    const service = data[0];

                    // 1. Update Slideshow
                    if (service.images && service.images.length > 0) {
                        const container = document.querySelector('.slideshow-container');
                        const controls = container.querySelector('.slide-controls');

                        // Remove old slides
                        container.querySelectorAll('.slide').forEach(el => el.remove());

                        // Add new slides
                        service.images.forEach((imgUrl, index) => {
                            const slide = document.createElement('div');
                            slide.className = `slide ${index === 0 ? 'active' : ''}`;
                            slide.style.backgroundImage = `url('${imgUrl}')`;
                            container.insertBefore(slide, controls);
                        });

                        // Re-init slideshow
                        initSlideshow();
                    }

                    // 2. Show Discount Toast/Banner if exists
                    if (service.discount) {
                        const discountToast = document.createElement('div');
                        discountToast.className = 'glass-panel p-3 text-center mb-4 border-gold animation-pulse';
                        discountToast.style.border = '2px dashed #fcdc3b';
                        discountToast.style.background = 'rgba(252, 220, 59, 0.1)';
                        discountToast.innerHTML = `
                            <h4 class="text-gold m-0 fw-bold"><i class="fas fa-tags me-2"></i> ${service.discount}</h4>
                            ${service.description ? `<p class="text-white-50 m-0 small mt-1">${service.description}</p>` : ''}
                        `;
                        // Insert after hero title
                        const title = document.querySelector('.hero-title');
                        title.parentNode.insertBefore(discountToast, title.nextSibling);
                    }
                } else {
                    initSlideshow();
                }
            } catch (e) {
                console.error('Failed to load dynamic content', e);
                initSlideshow();
            }
        }

        // Slideshow
        let slideIndex = 0;
        let slideTimer;

        function initSlideshow() {
            const slides = document.querySelectorAll('.slide');
            if (slides.length === 0) return;

            // Reset state
            slideIndex = 0;
            if (slideTimer) clearTimeout(slideTimer);

            showSlide(0);
        }

        function showSlide(index) {
            const slides = document.querySelectorAll('.slide');
            if (slides.length === 0) return;

            if (index >= slides.length) slideIndex = 0;
            else if (index < 0) slideIndex = slides.length - 1;
            else slideIndex = index;

            slides.forEach(s => s.classList.remove('active'));
            slides[slideIndex].classList.add('active');

            clearTimeout(slideTimer);
            slideTimer = setTimeout(() => {
                showSlide(slideIndex + 1);
            }, 4000);
        }

        function changeSlide(n) {
            showSlide(slideIndex + n);
        }

        const bookingModal = new bootstrap.Modal(document.getElementById('bookingModal'));
        const detailsModal = new bootstrap.Modal(document.getElementById('detailsModal'));
        let currentPackage = '';

        function openDetailsModal(type) {
            const title = document.getElementById('detailTitle');
            const content = document.getElementById('detailContent');
            const btn = document.getElementById('detailBookBtn');

            let html = '';
            let packageName = '';

            if (type === 'photo') {
                packageName = 'Professional Photography';
                html = `
                    <div id="carouselPhoto" class="carousel slide mb-4 rounded overflow-hidden" data-bs-ride="carousel">
                        <div class="carousel-inner">
                            <div class="carousel-item active"><img src="camera-sample-1.jpg" class="d-block w-100" style="height:300px; object-fit:cover;"></div>
                            <div class="carousel-item"><img src="camera sample 2.jpg" class="d-block w-100" style="height:300px; object-fit:cover;"></div>
                            <div class="carousel-item"><img src="camera sample 3.jpg" class="d-block w-100" style="height:300px; object-fit:cover;"></div>
                        </div>
                    </div>
                    <h4 class="text-warning">Features</h4>
                    <ul class="text-white-50">
                        <li>High-Resolution Full Frame Cameras</li>
                        <li>Professional Lighting Setup</li>
                        <li>Unlimited Edited Digital Copies</li>
                        <li>1 Premium Photo Album</li>
                    </ul>
                    <h3 class="text-warning mt-3">Starts at ₹10,000</h3>
                `;
            } else if (type === 'video') {
                packageName = 'Cinematic Videography';
                html = `
                    <video src="travel 4.mp4" controls class="w-100 rounded mb-4" style="max-height:300px;"></video>
                     <h4 class="text-warning">Features</h4>
                    <ul class="text-white-50">
                        <li>4K Cinematic Recording</li>
                        <li>Drone Coverage (Optional)</li>
                        <li>Professional Audio Capture</li>
                        <li>3-5 Minute Highlight Reel + Full Event Coverage</li>
                    </ul>
                    <h3 class="text-warning mt-3">Starts at ₹20,000</h3>
                `;
            } else {
                packageName = 'All-Inclusive Package';
                html = `
                     <div class="row mb-4">
                        <div class="col-6"><img src="camera sample 3.jpg" class="img-fluid rounded"></div>
                        <div class="col-6"><video src="travel 4.mp4" class="img-fluid rounded"></video></div>
                     </div>
                     <h4 class="text-warning">Features</h4>
                    <ul class="text-white-50">
                        <li>Complete Photography & Videography Coverage</li>
                        <li>2 Photographers + 2 Videographers</li>
                        <li>Drone Coverage Included</li>
                        <li>Premium Hardcover Albums</li>
                        <li>Teaser Video + Full Film</li>
                    </ul>
                    <h3 class="text-warning mt-3">Starts at ₹30,000</h3>
                `;
            }

            title.textContent = packageName;
            content.innerHTML = html;
            currentPackage = packageName;

            btn.onclick = () => {
                detailsModal.hide();
                openBookingModal(packageName);
            };

            detailsModal.show();
        }

        function openBookingModal(pkgName) {
            // document.getElementById('bookingTitle').textContent = `Book: ${pkgName || 'Session'}`; // Title is now generic
            const displayPkg = pkgName || 'General Inquiry';
            currentPackage = displayPkg;

            const banner = document.getElementById('displayPackage');
            if (banner) banner.innerText = displayPkg;

            if (window.Clerk && Clerk.user) {
                document.getElementById('name').value = Clerk.user.fullName || '';
                document.getElementById('email').value = Clerk.user.primaryEmailAddress.emailAddress || '';
                fetch(`/api/user/${Clerk.user.id}`)
                    .then(res => res.json())
                    .then(user => {
                        if (user && user.clerkId) {
                            if (user.phone) document.getElementById('phone').value = user.phone;
                            if (user.location) document.getElementById('address').value = user.location;
                        }
                    }).catch(e => console.log(e));
            }

            bookingModal.show();
        }

        // --- TOAST NOTIFICATION SYSTEM ---
        function showToast(message, type = 'success') {
            const container = document.getElementById('toastContainer');
            if (!container) return alert(message); // Fallback

            const toast = document.createElement('div');
            const icon = type === 'success' ? 'bi-check-circle-fill' : 'bi-exclamation-triangle-fill';

            toast.className = `toast-notify ${type}`;
            toast.innerHTML = `
                <i class="bi ${icon} toast-icon"></i>
                <div>
                    <div style="font-weight:600; font-size:0.95em;">${type === 'success' ? 'Success' : 'Error'}</div>
                    <div style="font-size:0.9em; opacity:0.9;">${message}</div>
                </div>
            `;

            container.appendChild(toast);

            // Trigger animation
            requestAnimationFrame(() => {
                toast.classList.add('show');
            });

            // Remove after 3s
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 400);
            }, 3000);
        }

        async function handleBooking(e) {
            e.preventDefault();

            // UI Feedback - Button Loading State
            const btn = e.target.querySelector('button[type="submit"]');
            const originalText = btn.innerHTML;
            btn.innerHTML = '<span class="spinner-border spinner-border-sm me-2"></span>Processing...';
            btn.disabled = true;

            const bookingData = {
                clerkId: window.Clerk?.user?.id,
                name: document.getElementById('name').value,
                phone: document.getElementById('phone').value,
                email: document.getElementById('email').value,
                address: document.getElementById('address').value,
                serviceType: 'Photography',
                serviceName: currentPackage,
                date: document.getElementById('date').value,
                // Map directly to Schema fields
                eventType: document.getElementById('eventType').value,
                photographyDuration: document.getElementById('duration').value,
                status: 'Pending'
            };

            try {
                const res = await fetch('/api/bookings', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(bookingData)
                });

                const result = await res.json();

                if (result.success) {
                    bookingModal.hide();

                    // Show success toast instead of alert
                    showToast('Booking submitted successfully!', 'success');

                    // Optional: Show success modal too after a slight delay
                    setTimeout(() => {
                        new bootstrap.Modal(document.getElementById('successModal')).show();
                    }, 500);

                    e.target.reset();
                } else {
                    showToast(result.error || 'Failed to submit booking.', 'error');
                }
            } catch (err) {
                console.error(err);
                showToast('Network error. Please try again.', 'error');
            } finally {
                // Reset Button
                btn.innerHTML = originalText;
                btn.disabled = false;
            }
        }

        // Clerk Init
        window.addEventListener('load', async function () {
            await loadDynamicContent();

            if (window.Clerk) {
                await window.Clerk.load({
                    appearance: {
                        baseTheme: 'dark',
                        variables: {
                            colorPrimary: '#fcdc3b',
                            colorBackground: '#0f0f0f',
                            colorText: 'white',
                            borderRadius: '12px',
                            fontFamily: "'Outfit', sans-serif"
                        }
                    }
                });

                if (Clerk.user) {
                    Clerk.mountUserButton(document.getElementById('user-button'));
                } else {
                    const userButton = document.getElementById('user-button');
                    userButton.innerHTML = '<button class="btn-primary-glow" onclick="Clerk.openSignIn()">Sign In</button>';
                }
            }
        });
    </script>
</body>

</html>